# Managed by chezmoi (private_ => 0600)
# Loads LLM API keys from LastPass using chezmoi's `lastpass` template function.
# `lastpass` calls `lpass show --json <id>` and parses the note field into key/value pairs. :contentReference[oaicite:5]{index=5}

{{- $hasLpass := findExecutable "lpass" (env "PATH") -}}
{{- if $hasLpass -}}
{{- if exec "lpass" "status" -}} {{/* exec returns true/false; errors only if command not found */}} {{- /* :contentReference[oaicite:6]{index=6} */ -}}
{{- $item := index (lastpass .lastpassLLMItem) 0 -}}
# Expect these keys in the LastPass note:
# openai_api_key: ...
# anthropic_api_key: ...
# gemini_api_key: ...
# (add any others you want)
export OPENAI_API_KEY={{ (default "" $item.note.openai_api_key) | quote }}
export ANTHROPIC_API_KEY={{ (default "" $item.note.anthropic_api_key) | quote }}
export GEMINI_API_KEY={{ (default "" $item.note.gemini_api_key) | quote }}
{{- else -}}
# LastPass is installed but not logged in.
# Run: lpass login {{ .lastpassLoginEmail | quote }}
{{- end -}}
{{- else -}}
# LastPass CLI (lpass) not installed yet.
{{- end -}}
