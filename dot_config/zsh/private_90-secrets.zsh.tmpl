# Managed by chezmoi (private_ => 0600)
# Loads LLM API keys from LastPass. Item names are the env var names.

if command -v lpass >/dev/null 2>&1; then
  if lpass status >/dev/null 2>&1; then
    keys=(OPENAI_API_KEY ANTHROPIC_API_KEY GEMINI_API_KEY VERCEL_TOKEN)
    for key in "${keys[@]}"; do
      value=""
      if lpass show --note "$key" >/dev/null 2>&1; then
        value="$(lpass show --note "$key" 2>/dev/null | tr -d '\r')"
      elif lpass show --password "$key" >/dev/null 2>&1; then
        value="$(lpass show --password "$key" 2>/dev/null | tr -d '\r')"
      fi
      export "$key"="$value"
    done
  else
    # LastPass is installed but not logged in.
    # Run: lpass login {{ .lastpassLoginEmail | quote }}
    :
  fi
else
  # LastPass CLI (lpass) not installed yet.
  :
fi
