# Managed by chezmoi (private_ => 0600)
# Loads LLM API keys from LastPass. Item names are the env var names.

{{- $hasLpass := findExecutable "lpass" (env "PATH") -}}
{{- if $hasLpass -}}
{{- if exec "lpass" "status" -}}
{{- $keys := list "OPENAI_API_KEY" "ANTHROPIC_API_KEY" "GEMINI_API_KEY" -}}
{{- range $keys }}
{{- $value := "" -}}
{{- if exec "lpass" "show" "--note" . -}}
{{- $value = (output "lpass" "show" "--note" .) | trim -}}
{{- else if exec "lpass" "show" "--password" . -}}
{{- $value = (output "lpass" "show" "--password" .) | trim -}}
{{- end -}}
export {{ . }}={{ $value | quote }}
{{- end -}}
{{- else -}}
# LastPass is installed but not logged in.
# Run: lpass login {{ .lastpassLoginEmail | quote }}
{{- end -}}
{{- else -}}
# LastPass CLI (lpass) not installed yet.
{{- end -}}
